var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var A=(o,e,t)=>e in o?Z(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,D=(o,e)=>{for(var t in e||(e={}))oe.call(e,t)&&A(o,t,e[t]);if(N)for(var t of N(e))ae.call(e,t)&&A(o,t,e[t]);return o},P=(o,e)=>ee(o,te(e));import{d as se,a as R,u as F,i as ne,o as f,c as m,b as l,t as ie,e as y,p as q,f as z,r as h,g as re,h as ce,w as U,v as j,j as le,k as de,l as ue,m as ve,n as fe,q as B,s as pe,x as V,F as _e,y as he,z as me,V as ge}from"./vendor.9aad4e88.js";const ye=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}};ye();const G=se("global",{state:()=>({scanText:""}),actions:{setScanText(o){this.scanText=o}}});var K=(o,e)=>{const t=o.__vccOpts||o;for(const[i,a]of e)t[i]=a;return t};const we=o=>(q("data-v-acc410f4"),o=o(),z(),o),ke={class:"main"},Re={class:"content is-normal"},Se=we(()=>l("h3",null,"scan result",-1)),be={class:"block scan-result"},xe=R({name:"Home",setup(o){const e=F(),t=G(),i=ne.exports.useToast(),a=()=>{e.push("/scan")},n=async()=>{await navigator.clipboard.writeText(t.scanText),i.success("success copied!",{position:"top",duration:1500})};return(s,d)=>(f(),m("div",ke,[l("div",Re,[Se,l("p",be,ie(y(t).scanText),1)]),l("div",{class:"action"},[l("button",{class:"button is-primary is-medium is-fullwidth",onClick:a},"Scan"),l("button",{class:"button is-info is-medium is-fullwidth",onClick:n},"Copy")])]))}});var We=K(xe,[["__scopeId","data-v-acc410f4"]]);function Ee(){return new Worker("/assets/decode-worker.5da45328.js",{type:"module"})}const Ce=o=>(q("data-v-0e3b6c3a"),o=o(),z(),o),Me={class:"scanner"},Te=Ce(()=>l("div",{class:"square"},[l("div",{class:"scan-line"})],-1)),$e=["width"],Ie=["width","height"],Oe=R({name:"Scanner",props:{frontCamera:{type:Boolean,default:!1}},emits:["media-error","onsuccess"],setup(o,{emit:e}){const t=o;let i,a=!0,n;const s=h({width:document.documentElement.clientWidth*2,height:document.documentElement.clientHeight*2}),d=h(document.documentElement.clientWidth),S=h(0);let r=0,p=0;const c=h(),C=h();let b=null,x=0,M=0,w=0,k=0,T=0,$=0;const X=Math.floor(1e3/30);let I=0,E=-1;const Y=async _=>{if(_-I>=X&&c.value&&c.value.readyState===c.value.HAVE_ENOUGH_DATA&&(I=_,b&&c.value&&(b.drawImage(c.value,T,$,w,k,0,0,s.value.width,s.value.height),a))){a=!1;const g=b.getImageData(0,0,s.value.width,s.value.height);i.postMessage({imageData:g},[g.data.buffer])}O()},O=()=>{E=requestAnimationFrame(Y)},J=async function(){if(navigator.mediaDevices&&typeof navigator.mediaDevices.getUserMedia=="function"){const _=()=>{var u,v;b=(v=(u=C.value)==null?void 0:u.getContext("2d"))!=null?v:null,i&&i.terminate(),i=new Ee,i.addEventListener("message",L=>{L.data?(e("onsuccess",L.data.data),H()):a=!0})},g=async u=>{var v;!c.value||(n=u,(v=c.value)!=null&&v.srcObject?c.value.src=URL.createObjectURL(u):c.value.srcObject=u,await c.value.play(),r=c.value.videoWidth,p=c.value.videoHeight,x=s.value.width/s.value.height,M=r/p,console.log("videoSize",r,p,s.value.width,s.value.height),M>x?(k=p,w=Math.floor(k*x),T=Math.floor((r-w)/2)):(w=r,k=Math.floor(w/x),$=Math.floor((p-k)/2)),_(),O())},Q=t.frontCamera?"user":{exact:"environment"};try{const u=await navigator.mediaDevices.getUserMedia({video:{facingMode:Q,width:{ideal:1280},height:{ideal:720}}});g(u)}catch{try{const v=await navigator.mediaDevices.getUserMedia({video:!0});g(v)}catch(v){e("media-error",v)}}}},H=()=>{i&&i.terminate(),n&&(typeof(n==null?void 0:n.stop)=="function"?n.stop():n.getTracks().forEach(_=>_.stop())),E>-1&&cancelAnimationFrame(E)};return re(async()=>{S.value=parseInt(window.getComputedStyle(c.value).height),await J()}),ce(async()=>{H()}),(_,g)=>(f(),m("div",Me,[Te,U(l("video",{class:"video",ref_key:"videoElRef",ref:c,width:d.value,playsinline:""},null,8,$e),[[j,!0]]),U(l("canvas",{ref_key:"canvasElRef",ref:C,width:s.value.width,height:s.value.height,class:"canvas"},null,8,Ie),[[j,!0]])]))}});var He=K(Oe,[["__scopeId","data-v-0e3b6c3a"]]);const Le={beforeRouteEnter(o,e,t){console.log(e),e.href?t():t("/")}},Ne=R(P(D({},Le),{name:"Scan",setup(o){const e=G(),t=F(),i=a=>{e.setScanText(a),t.back()};return(a,n)=>(f(),le(He,{onOnsuccess:i}))}})),Ae=[{path:"/",component:We},{path:"/scan",component:Ne},{path:"/:pathMatch(.*)*",redirect:"/"}],De=de({history:ue(),routes:Ae});function Pe(o){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:a,onRegisterError:n}=o;let s,d;const S=async(r=!0)=>{r&&(s==null||s.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()})),d&&d.waiting&&await fe(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){s=new ve("/sw.js",{scope:"/",type:"classic"}),s.addEventListener("activated",r=>{r.isUpdate||i==null||i()});{const r=()=>{t==null||t()};s.addEventListener("waiting",r),s.addEventListener("externalwaiting",r)}s.register({immediate:e}).then(r=>{d=r,a==null||a(r)}).catch(r=>{n==null||n(r)})}return S}function Ue(o={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:a,onRegisterError:n}=o,s=h(!1),d=h(!1);return{updateServiceWorker:Pe({immediate:e,onNeedRefresh(){s.value=!0,t==null||t()},onOfflineReady(){d.value=!0,i==null||i()},onRegistered:a,onRegisterError:n}),offlineReady:d,needRefresh:s}}const je={key:0,class:"pwa-toast",role:"alert"},Be={class:"message"},Ve={key:0},Fe={key:1},qe=R({name:"ReloadPrompt",setup(o){const{offlineReady:e,needRefresh:t,updateServiceWorker:i}=Ue(),a=async()=>{e.value=!1,t.value=!1};return(n,s)=>y(e)||y(t)?(f(),m("div",je,[l("div",Be,[y(e)?(f(),m("span",Ve," App ready to work offline ")):(f(),m("span",Fe," New content available, click on reload button to update. "))]),y(t)?(f(),m("button",{key:0,onClick:s[0]||(s[0]=d=>y(i)())}," Reload ")):B("",!0),l("button",{onClick:a}," Close ")])):B("",!0)}});const ze={class:"app"},Ge=R({name:"App",setup(o){return(e,t)=>{const i=pe("router-view");return f(),m(_e,null,[l("div",ze,[V(i)]),V(qe)],64)}}}),W=he(Ge);W.use(De);W.use(me());W.use(ge);W.mount("#app");
