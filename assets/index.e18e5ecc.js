var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var P=(a,t,e)=>t in a?ee(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,U=(a,t)=>{for(var e in t||(t={}))ae.call(t,e)&&P(a,e,t[e]);if(V)for(var e of V(t))oe.call(t,e)&&P(a,e,t[e]);return a},j=(a,t)=>te(a,se(t));import{d as ne,a as x,u as q,i as ie,V as ce,b as re,o as _,c as g,e as d,n as S,t as le,f as p,g as w,w as T,m as de,h as G,r as m,j as ue,k as fe,l as z,v as B,p as ve,q as pe,s as _e,x as he,y as me,z as ge,A as ye,B as F,C as we,F as be,D as Re,E as ke,G as Se,H as xe,I as Ce,J as Ee}from"./vendor.e3f04d45.js";const We=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}};We();const K=ne("global",{state:()=>({scanText:""}),actions:{setScanText(a){this.scanText=a}}}),$e="_action_c3aan_2",Te="_button_c3aan_11",Me="_scanResult_c3aan_17";var Ie={action:$e,button:Te,scanResult:Me},J=(a,t)=>{const e=a.__vccOpts||a;for(const[i,s]of t)e[i]=s;return e};const Oe={class:"main"},Ne={class:"content is-normal"},Ae=d("h3",null,"scan result",-1),He={class:"flex justify-between"},Le=G(" Open it "),De=G(" Copy text "),Ve={class:"flex justify-between"},Pe=x({name:"Home",setup(a){const t=q(),e=K(),i=ie.exports.useToast(),s=()=>{t.push("/scan")},n=async()=>{await navigator.clipboard.writeText(e.scanText),i.success("success copied!",{position:"top",duration:1500})},o=()=>{window.open(e.scanText,"_blank")};return(r,b)=>{const c=ce,u=re;return _(),g("div",Oe,[d("div",Ne,[Ae,d("p",{class:S(["block",r.$style.scanResult])},le(p(e).scanText),3),d("div",He,[w(c,{disabled:p(e).scanText.length===0,class:S([r.$style.button,"w-44vw"]),flat:"",size:"small",color:"info",onClick:o},{default:T(()=>[Le]),_:1},8,["disabled","class"]),w(c,{disabled:p(e).scanText.length===0,class:S([r.$style.button,"w-44vw"]),flat:"",size:"small",color:"info",onClick:n},{default:T(()=>[De]),_:1},8,["disabled","class"])])]),d("div",{class:S(r.$style.action)},[d("div",Ve,[w(c,{class:S([r.$style.button,"w-44vw"]),block:"",flat:"",size:"large",color:"success",onClick:s},{default:T(()=>[w(u,{size:"x-large",icon:p(de)},null,8,["icon"])]),_:1},8,["class"])])],2)])}}}),Ue={$style:Ie};var je=J(Pe,[["__cssModules",Ue]]);function ze(){return new Worker("/assets/decode-worker.5da45328.js",{type:"module"})}const Be=a=>(ve("data-v-0e3b6c3a"),a=a(),pe(),a),Fe={class:"scanner"},qe=Be(()=>d("div",{class:"square"},[d("div",{class:"scan-line"})],-1)),Ge=["width"],Ke=["width","height"],Je=x({name:"Scanner",props:{frontCamera:{type:Boolean,default:!1}},emits:["media-error","onsuccess"],setup(a,{emit:t}){const e=a;let i,s=!0,n;const o=m({width:document.documentElement.clientWidth*2,height:document.documentElement.clientHeight*2}),r=m(document.documentElement.clientWidth),b=m(0);let c=0,u=0;const l=m(),M=m();let E=null,W=0,I=0,R=0,k=0,O=0,N=0;const X=Math.floor(1e3/30);let A=0,$=-1;const Y=async h=>{if(h-A>=X&&l.value&&l.value.readyState===l.value.HAVE_ENOUGH_DATA&&(A=h,E&&l.value&&(E.drawImage(l.value,O,N,R,k,0,0,o.value.width,o.value.height),s))){s=!1;const y=E.getImageData(0,0,o.value.width,o.value.height);i.postMessage({imageData:y},[y.data.buffer])}H()},H=()=>{$=requestAnimationFrame(Y)},Q=async function(){if(navigator.mediaDevices&&typeof navigator.mediaDevices.getUserMedia=="function"){const h=()=>{var f,v;E=(v=(f=M.value)==null?void 0:f.getContext("2d"))!=null?v:null,i&&i.terminate(),i=new ze,i.addEventListener("message",D=>{D.data?(t("onsuccess",D.data.data),L()):s=!0})},y=async f=>{var v;!l.value||(n=f,(v=l.value)!=null&&v.srcObject?l.value.src=URL.createObjectURL(f):l.value.srcObject=f,await l.value.play(),c=l.value.videoWidth,u=l.value.videoHeight,W=o.value.width/o.value.height,I=c/u,console.log("videoSize",c,u,o.value.width,o.value.height),I>W?(k=u,R=Math.floor(k*W),O=Math.floor((c-R)/2)):(R=c,k=Math.floor(R/W),N=Math.floor((u-k)/2)),h(),H())},Z=e.frontCamera?"user":{exact:"environment"};try{const f=await navigator.mediaDevices.getUserMedia({video:{facingMode:Z,width:{ideal:1280},height:{ideal:720}}});y(f)}catch{try{const v=await navigator.mediaDevices.getUserMedia({video:!0});y(v)}catch(v){t("media-error",v)}}}},L=()=>{i&&i.terminate(),n&&(typeof(n==null?void 0:n.stop)=="function"?n.stop():n.getTracks().forEach(h=>h.stop())),$>-1&&cancelAnimationFrame($)};return ue(async()=>{b.value=parseInt(window.getComputedStyle(l.value).height),await Q()}),fe(async()=>{L()}),(h,y)=>(_(),g("div",Fe,[qe,z(d("video",{class:"video",ref_key:"videoElRef",ref:l,width:r.value,playsinline:""},null,8,Ge),[[B,!0]]),z(d("canvas",{ref_key:"canvasElRef",ref:M,width:o.value.width,height:o.value.height,class:"canvas"},null,8,Ke),[[B,!0]])]))}});var Xe=J(Je,[["__scopeId","data-v-0e3b6c3a"]]);const Ye={beforeRouteEnter(a,t,e){console.log(t),t.href?e():e("/")}},Qe=x(j(U({},Ye),{name:"Scan",setup(a){const t=K(),e=q(),i=s=>{t.setScanText(s),e.back()};return(s,n)=>(_(),_e(Xe,{onOnsuccess:i}))}})),Ze=[{path:"/",component:je},{path:"/scan",component:Qe},{path:"/:pathMatch(.*)*",redirect:"/"}],et=he({history:me(),routes:Ze});function tt(a){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:i,onRegistered:s,onRegisterError:n}=a;let o,r;const b=async(c=!0)=>{c&&(o==null||o.addEventListener("controlling",u=>{u.isUpdate&&window.location.reload()})),r&&r.waiting&&await ye(r.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){o=new ge("/sw.js",{scope:"/",type:"classic"}),o.addEventListener("activated",c=>{c.isUpdate||i==null||i()});{const c=()=>{e==null||e()};o.addEventListener("waiting",c),o.addEventListener("externalwaiting",c)}o.register({immediate:t}).then(c=>{r=c,s==null||s(c)}).catch(c=>{n==null||n(c)})}return b}function st(a={}){const{immediate:t=!0,onNeedRefresh:e,onOfflineReady:i,onRegistered:s,onRegisterError:n}=a,o=m(!1),r=m(!1);return{updateServiceWorker:tt({immediate:t,onNeedRefresh(){o.value=!0,e==null||e()},onOfflineReady(){r.value=!0,i==null||i()},onRegistered:s,onRegisterError:n}),offlineReady:r,needRefresh:o}}const at={key:0,class:"pwa-toast",role:"alert"},ot={class:"message"},nt={key:0},it={key:1},ct=x({name:"ReloadPrompt",setup(a){const{offlineReady:t,needRefresh:e,updateServiceWorker:i}=st(),s=async()=>{t.value=!1,e.value=!1};return(n,o)=>p(t)||p(e)?(_(),g("div",at,[d("div",ot,[p(t)?(_(),g("span",nt," App ready to work offline ")):(_(),g("span",it," New content available, click on reload button to update. "))]),p(e)?(_(),g("button",{key:0,onClick:o[0]||(o[0]=r=>p(i)())}," Reload ")):F("",!0),d("button",{onClick:s}," Close ")])):F("",!0)}});const rt={class:"app"},lt=x({name:"App",setup(a){return(t,e)=>{const i=we("router-view");return _(),g(be,null,[d("div",rt,[w(i)]),w(ct)],64)}}});function dt(){return Re({components:{},icons:{defaultSet:"mdi",aliases:ke,sets:{mdi:Se}}})}const C=xe(lt);C.use(dt());C.use(et);C.use(Ce());C.use(Ee);C.mount("#app");
