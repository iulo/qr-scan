var ee=Object.defineProperty,te=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var H=(a,t,e)=>t in a?ee(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,L=(a,t)=>{for(var e in t||(t={}))ae.call(t,e)&&H(a,e,t[e]);if(D)for(var e of D(t))ne.call(t,e)&&H(a,e,t[e]);return a},V=(a,t)=>te(a,oe(t));import{d as ie,a as S,u as F,i as se,V as re,b as le,o as h,c as g,e as d,n as R,t as ce,f as m,g as w,w as M,m as de,h as G,r as _,j as ue,k as pe,l as P,v as B,p as fe,q as me,s as he,x as ve,y as _e,z as ge,A as be,B as q,C as we,F as ye,D as xe,E as ke,G as Re,H as Se,I as Ce,J as Ee}from"./vendor.4d699ec1.js";const ze=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}};ze();const K=ie("global",{state:()=>({scanText:""}),actions:{setScanText(a){this.scanText=a}}}),Ie="_action_c3aan_2",Me="_button_c3aan_11",We="_scanResult_c3aan_17";var je={action:Ie,button:Me,scanResult:We},J=(a,t)=>{const e=a.__vccOpts||a;for(const[s,o]of t)e[s]=o;return e};const $e={class:"main"},Te={class:"content is-normal"},Ae=d("h3",null,"scan result",-1),Ue={class:"flex justify-between"},Ne=G(" Open it "),Oe=G(" Copy text "),De={class:"flex justify-between"},He=S({__name:"Home",setup(a){const t=F(),e=K(),s=se.exports.useToast(),o=()=>{t.push("/scan")},i=async()=>{await navigator.clipboard.writeText(e.scanText),s.success("success copied!",{position:"top",duration:1500})},n=()=>{window.open(e.scanText,"_blank")};return(l,y)=>{const r=re,u=le;return h(),g("div",$e,[d("div",Te,[Ae,d("p",{class:R(["block",l.$style.scanResult])},ce(m(e).scanText),3),d("div",Ue,[w(r,{disabled:m(e).scanText.length===0,class:R([l.$style.button,"w-44vw"]),flat:"",size:"small",color:"info",onClick:n},{default:M(()=>[Ne]),_:1},8,["disabled","class"]),w(r,{disabled:m(e).scanText.length===0,class:R([l.$style.button,"w-44vw"]),flat:"",size:"small",color:"info",onClick:i},{default:M(()=>[Oe]),_:1},8,["disabled","class"])])]),d("div",{class:R(l.$style.action)},[d("div",De,[w(r,{class:R([l.$style.button,"w-44vw"]),block:"",flat:"",size:"large",color:"success",onClick:o},{default:M(()=>[w(u,{size:"x-large",icon:m(de)},null,8,["icon"])]),_:1},8,["class"])])],2)])}}}),Le={$style:je};var Ve=J(He,[["__cssModules",Le]]);function Pe(){return new Worker("/assets/decode-worker.5da45328.js",{type:"module"})}const Be=a=>(fe("data-v-0e3b6c3a"),a=a(),me(),a),qe={class:"scanner"},Fe=Be(()=>d("div",{class:"square"},[d("div",{class:"scan-line"})],-1)),Ge=["width"],Ke=["width","height"],Je=S({__name:"Scanner",props:{frontCamera:{type:Boolean,default:!1}},emits:["media-error","onsuccess"],setup(a,{emit:t}){const e=a;let s,o=!0,i;const n=_({width:document.documentElement.clientWidth*2,height:document.documentElement.clientHeight*2}),l=_(document.documentElement.clientWidth),y=_(0);let r=0,u=0;const c=_(),W=_();let E=null,z=0,j=0,x=0,k=0,$=0,T=0;const X=Math.floor(1e3/30);let A=0,I=-1;const Y=async v=>{if(v-A>=X&&c.value&&c.value.readyState===c.value.HAVE_ENOUGH_DATA&&(A=v,E&&c.value&&(E.drawImage(c.value,$,T,x,k,0,0,n.value.width,n.value.height),o))){o=!1;const b=E.getImageData(0,0,n.value.width,n.value.height);s.postMessage({imageData:b},[b.data.buffer])}U()},U=()=>{I=requestAnimationFrame(Y)},Q=async function(){if(navigator.mediaDevices&&typeof navigator.mediaDevices.getUserMedia=="function"){const v=()=>{var p,f;E=(f=(p=W.value)==null?void 0:p.getContext("2d"))!=null?f:null,s&&s.terminate(),s=new Pe,s.addEventListener("message",O=>{O.data?(t("onsuccess",O.data.data),N()):o=!0})},b=async p=>{var f;!c.value||(i=p,(f=c.value)!=null&&f.srcObject?c.value.src=URL.createObjectURL(p):c.value.srcObject=p,await c.value.play(),r=c.value.videoWidth,u=c.value.videoHeight,z=n.value.width/n.value.height,j=r/u,console.log("videoSize",r,u,n.value.width,n.value.height),j>z?(k=u,x=Math.floor(k*z),$=Math.floor((r-x)/2)):(x=r,k=Math.floor(x/z),T=Math.floor((u-k)/2)),v(),U())},Z=e.frontCamera?"user":{exact:"environment"};try{const p=await navigator.mediaDevices.getUserMedia({video:{facingMode:Z,width:{ideal:1280},height:{ideal:720}}});b(p)}catch{try{const f=await navigator.mediaDevices.getUserMedia({video:!0});b(f)}catch(f){t("media-error",f)}}}},N=()=>{s&&s.terminate(),i&&(typeof(i==null?void 0:i.stop)=="function"?i.stop():i.getTracks().forEach(v=>v.stop())),I>-1&&cancelAnimationFrame(I)};return ue(async()=>{y.value=parseInt(window.getComputedStyle(c.value).height),await Q()}),pe(async()=>{N()}),(v,b)=>(h(),g("div",qe,[Fe,P(d("video",{class:"video",ref_key:"videoElRef",ref:c,width:l.value,playsinline:""},null,8,Ge),[[B,!0]]),P(d("canvas",{ref_key:"canvasElRef",ref:W,width:n.value.width,height:n.value.height,class:"canvas"},null,8,Ke),[[B,!0]])]))}});var Xe=J(Je,[["__scopeId","data-v-0e3b6c3a"]]);const Ye={beforeRouteEnter(a,t,e){console.log(t),t.href?e():e("/")}},Qe=S(V(L({},Ye),{__name:"Scan",setup(a){const t=K(),e=F(),s=o=>{t.setScanText(o),e.back()};return(o,i)=>(h(),he(Xe,{onOnsuccess:s}))}})),Ze=[{path:"/",component:Ve},{path:"/scan",component:Qe},{path:"/:pathMatch(.*)*",redirect:"/"}],et=ve({history:_e(),routes:Ze});function tt(a={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:s,onRegistered:o,onRegisterError:i}=a;let n,l;const y=async(r=!0)=>{r&&(n==null||n.addEventListener("controlling",u=>{u.isUpdate&&window.location.reload()})),l&&l.waiting&&await be(l.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){n=new ge("/sw.js",{scope:"/",type:"classic"}),n.addEventListener("activated",r=>{r.isUpdate||s==null||s()});{const r=()=>{e==null||e()};n.addEventListener("waiting",r),n.addEventListener("externalwaiting",r)}n.register({immediate:t}).then(r=>{l=r,o==null||o(r)}).catch(r=>{i==null||i(r)})}return y}function ot(a={}){const{immediate:t=!0,onNeedRefresh:e,onOfflineReady:s,onRegistered:o,onRegisterError:i}=a,n=_(!1),l=_(!1);return{updateServiceWorker:tt({immediate:t,onNeedRefresh(){n.value=!0,e==null||e()},onOfflineReady(){l.value=!0,s==null||s()},onRegistered:o,onRegisterError:i}),offlineReady:l,needRefresh:n}}const at={key:0,class:"pwa-toast",role:"alert"},nt={class:"message"},it={key:0},st={key:1},rt=S({__name:"ReloadPrompt",setup(a){const{offlineReady:t,needRefresh:e,updateServiceWorker:s}=ot(),o=async()=>{t.value=!1,e.value=!1};return(i,n)=>m(t)||m(e)?(h(),g("div",at,[d("div",nt,[m(t)?(h(),g("span",it," App ready to work offline ")):(h(),g("span",st," New content available, click on reload button to update. "))]),m(e)?(h(),g("button",{key:0,onClick:n[0]||(n[0]=l=>m(s)())}," Reload ")):q("",!0),d("button",{onClick:o}," Close ")])):q("",!0)}});const lt={class:"app"},ct=S({__name:"App",setup(a){return(t,e)=>{const s=we("router-view");return h(),g(ye,null,[d("div",lt,[w(s)]),w(rt)],64)}}});function dt(){return xe({components:{},icons:{defaultSet:"mdi",aliases:ke,sets:{mdi:Re}}})}const C=Se(ct);C.use(dt());C.use(et);C.use(Ce());C.use(Ee);C.mount("#app");
