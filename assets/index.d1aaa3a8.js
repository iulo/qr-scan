var Y=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var $=(e,t,a)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,L=(e,t)=>{for(var a in t||(t={}))Z.call(t,a)&&$(e,a,t[a]);if(A)for(var a of A(t))ee.call(t,a)&&$(e,a,t[a]);return e},U=(e,t)=>J(e,Q(t));import{d as te,a as x,u as j,i as ae,o as w,c as k,b as r,t as se,e as oe,p as P,f as V,r as m,g as ne,h as ce,w as B,v as N,j as ie,k as re,l as le,m as ue,n as de,q as ve,s as fe,V as pe}from"./vendor.47f10e22.js";const he=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}};he();const q=te("global",{state:()=>({scanText:""}),actions:{setScanText(e){this.scanText=e}}});var M=(e,t)=>{const a=e.__vccOpts||e;for(const[n,s]of t)a[n]=s;return a};const _e=e=>(P("data-v-acc410f4"),e=e(),V(),e),me={class:"main"},ge={class:"content is-normal"},ye=_e(()=>r("h3",null,"scan result",-1)),we={class:"block scan-result"},Se=x({name:"Home",setup(e){const t=j(),a=q(),n=ae.exports.useToast(),s=()=>{t.push("/scan")},o=async()=>{await navigator.clipboard.writeText(a.scanText),n.success("success copied!",{position:"top",duration:1500})};return(c,E)=>(w(),k("div",me,[r("div",ge,[ye,r("p",we,se(oe(a).scanText),1)]),r("div",{class:"action"},[r("button",{class:"button is-primary is-medium is-fullwidth",onClick:s},"Scan"),r("button",{class:"button is-info is-medium is-fullwidth",onClick:o},"Copy")])]))}});var be=M(Se,[["__scopeId","data-v-acc410f4"]]);function xe(){return new Worker("/assets/decode-worker.5da45328.js",{type:"module"})}const ke=e=>(P("data-v-0e3b6c3a"),e=e(),V(),e),Me={class:"scanner"},Ee=ke(()=>r("div",{class:"square"},[r("div",{class:"scan-line"})],-1)),Re=["width"],Te=["width","height"],Ce=x({name:"Scanner",props:{frontCamera:{type:Boolean,default:!1}},emits:["media-error","onsuccess"],setup(e,{emit:t}){const a=e;let n,s=!0,o;const c=m({width:document.documentElement.clientWidth*2,height:document.documentElement.clientHeight*2}),E=m(document.documentElement.clientWidth),F=m(0);let f=0,p=0;const i=m(),R=m();let g=null,y=0,T=0,h=0,_=0,C=0,H=0;const z=Math.floor(1e3/30);let W=0,b=-1;const G=async d=>{if(d-W>=z&&i.value&&i.value.readyState===i.value.HAVE_ENOUGH_DATA&&(W=d,g&&i.value&&(g.drawImage(i.value,C,H,h,_,0,0,c.value.width,c.value.height),s))){s=!1;const v=g.getImageData(0,0,c.value.width,c.value.height);n.postMessage({imageData:v},[v.data.buffer])}I()},I=()=>{b=requestAnimationFrame(G)},K=async function(){if(navigator.mediaDevices&&typeof navigator.mediaDevices.getUserMedia=="function"){const d=()=>{var l,u;g=(u=(l=R.value)==null?void 0:l.getContext("2d"))!=null?u:null,n&&n.terminate(),n=new xe,n.addEventListener("message",O=>{O.data?(t("onsuccess",O.data.data),D()):s=!0})},v=async l=>{var u;!i.value||(o=l,(u=i.value)!=null&&u.srcObject?i.value.src=URL.createObjectURL(l):i.value.srcObject=l,await i.value.play(),f=i.value.videoWidth,p=i.value.videoHeight,y=c.value.width/c.value.height,T=f/p,console.log("videoSize",f,p,c.value.width,c.value.height),T>y?(_=p,h=Math.floor(_*y),C=Math.floor((f-h)/2)):(h=f,_=Math.floor(h/y),H=Math.floor((p-_)/2)),d(),I())},X=a.frontCamera?"user":{exact:"environment"};try{const l=await navigator.mediaDevices.getUserMedia({video:{facingMode:X,width:{ideal:1280},height:{ideal:720}}});v(l)}catch{try{const u=await navigator.mediaDevices.getUserMedia({video:!0});v(u)}catch(u){t("media-error",u)}}}},D=()=>{n&&n.terminate(),o&&(typeof(o==null?void 0:o.stop)=="function"?o.stop():o.getTracks().forEach(d=>d.stop())),b>-1&&cancelAnimationFrame(b)};return ne(async()=>{F.value=parseInt(window.getComputedStyle(i.value).height),await K()}),ce(async()=>{D()}),(d,v)=>(w(),k("div",Me,[Ee,B(r("video",{class:"video",ref_key:"videoElRef",ref:i,width:E.value,playsinline:""},null,8,Re),[[N,!0]]),B(r("canvas",{ref_key:"canvasElRef",ref:R,width:c.value.width,height:c.value.height,class:"canvas"},null,8,Te),[[N,!0]])]))}});var He=M(Ce,[["__scopeId","data-v-0e3b6c3a"]]);const We={beforeRouteEnter(e,t,a){console.log(t),t.href?a():a("/")}},Ie=x(U(L({},We),{name:"Scan",setup(e){const t=q(),a=j(),n=s=>{t.setScanText(s),a.back()};return(s,o)=>(w(),ie(He,{onOnsuccess:n}))}})),De=[{path:"/",component:be},{path:"/scan",component:Ie},{path:"/:pathMatch(.*)*",redirect:"/"}],Oe=re({history:le(),routes:De});const Ae={},$e={class:"app"};function Le(e,t){const a=ue("router-view");return w(),k("div",$e,[de(a)])}var Ue=M(Ae,[["render",Le]]);const S=ve(Ue);S.use(Oe);S.use(fe());S.use(pe);S.mount("#app");
